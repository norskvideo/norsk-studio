__layout:
  - id: srtlistener-0
    x: 576
    y: 400
  - id: monetise-0
    x: 1008
    y: 400
  - id: fixedladder-1
    x: 1472
    y: 128
  - id: autocmaf-1
    x: 2000
    y: 400
nodes:
  - type: input.srt-listener
    config:
      displayName: srt-listener
      port: 5001
      ip: 0.0.0.0
      passphrase: ""
      sourceNames: permissive
      streamIds:
        - camera1
      id: srtlistener-0
    subscriptions: []
  - type: processor.monetise
    config:
      displayName: monetise
      iceServers:
        - stun:stun.l.google.com:19302
      id: monetise-0
    subscriptions:
      - source: srtlistener-0
        streams:
          type: take-specific-stream
          select:
            - audio
            - video
          filter: camera1
  - type: processor.transform.fixedLadder
    config:
      displayName: fixedLadder
      rungs:
        - h264_640x360
      id: fixedladder-1
    subscriptions:
      - source: monetise-0
        streams:
          type: take-first-stream
          select:
            - video
  - type: output.autoCmaf
    config:
      displayName: autoCmaf
      name: default
      sessionId: true
      segments:
        retentionPeriod: 120
        defaultSegmentCount: 12
        targetSegmentDuration: 8
        targetPartDuration: 1
      s3Destinations:
        - host: id3as-hls-test-bucket.s3.amazonaws.com
          prefix: /media_tailor_demo/tailor/
          includeAdInsertions: true
      id: autocmaf-1
    subscriptions:
      - source: monetise-0
        streams:
          type: take-first-stream
          select:
            - audio
            - ancillary
      - source: fixedladder-1
        streams:
          type: take-specific-streams
          select:
            - video
          filter:
            - h264_1920x1080
            - h264_1280x720
            - h264_640x360
